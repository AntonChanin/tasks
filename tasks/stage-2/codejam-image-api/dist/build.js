!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){const n=document.querySelector("canvas"),o=document.querySelector(".matrixs"),r=document.querySelector(".colors"),l=document.querySelector(".findLoc"),a=document.querySelector("#size"),c=document.querySelector("#load"),u=document.querySelector("#paint-bucket"),s=document.querySelector("#choose-color"),d=document.querySelector("#pencil"),f=document.querySelector(".current-color"),i=document.querySelector(".prev-color"),g=o.querySelector("#small"),b=o.querySelector("#medium"),y=o.querySelector("#big"),m=r.querySelector("#red"),k=r.querySelector("#blue");var h="https://api.unsplash.com/photos/random?query=town,Minsk&client_id=fec156f271c0811c8231098435c111c587352eaffae03b1d3a898cc877dd1b33",p=void 0,v="green",w="Minsk",S=void 0,q=document.querySelector("canvas"),L=q.getContext("2d"),j=!1;function E(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="json",n.onload=()=>{var e=n.status;200==e?t(null,n.response):t(e)},n.send()}function x(e,t){const o=""===a.value?1:a.value,r=e[0].length,l=e.length,c=10*o;n.width=r*c,n.height=l*c;for(let n=0;n<l;n++)for(let o=0;o<r;o++)L.fillStyle="hex"===t?"#"+e[n][o]:"rgba("+e[n][o]+")",L.fillRect(o*c,n*c,c,c);localStorage.setItem("imgData",q.toDataURL())}function M(e,t){L.clearRect(0,0,q.width,q.height);const o=""===a.value?1:a.value,r=e||drawing.width,l=e||drawing.height,c=1*o;n.width=r*c,n.height=l*c,drawing=new Image,drawing.setAttribute("crossOrigin",""),drawing.src=t||"./data/image.png",drawing.classList.add("trueSize"),drawing.onload=()=>{L.drawImage(drawing,0,0)},localStorage.setItem("imgData",drawing.src)}function I(e){alert("Something went wrong: "+e)}function O(e){e==m?(p=v,v="red",f.style.background=v,i.style.background=p):e==k?(p=v,v="blue",f.style.background=v,i.style.background=p):e==v?(p=v,f.style.background=v,i.style.background=p):(p=v=p,f.style.background=v,i.style.background=p),L.fillStyle=v}n.addEventListener("mousedown",(function(){!0})),n.addEventListener("mouseup",(function(){!1})),f.style.background=v;let D=localStorage.getItem("imgData")||null;if(null!==D){let e=new Image;e.src=D,e.onload=()=>{L.drawImage(e,0,0,512,512)}}function R(){const e=10*(""===a.value?1:a.value);null!=S&&(S.style.background="#ffffff"),(S=u).style.background="rgba(180, 149, 255, 0.5)";for(let t=0;t<q.height;t++)for(let n=0;n<q.width;n++)L.fillStyle=v,L.fillRect(n*e,t*e,e,e)}g.addEventListener("click",()=>{E("https://raw.githubusercontent.com/AntonChanin/tasks/master/tasks/stage-2/codejam-canvas/data/4x4.json",(e,t)=>{e?I(e):x(t,"hex")})}),b.addEventListener("click",()=>{E("https://raw.githubusercontent.com/rolling-scopes-school/tasks/master/tasks/stage-2/codejam-canvas/data/32x32.json",(e,t)=>{e?I(e):x(t,"rgba")})}),y.addEventListener("click",()=>{M(256)}),["#current-color","#prev-color","#red","#blue","#choose-color","#transform","#pencil","#small","#medium","#big"].map(e=>{!function(e){document.querySelector(e).onmousedown=()=>{null!=S&&(S.style.background="#ffffff"),(S=document.querySelector(e)).style.background="rgba(180, 149, 255, 0.5)",f.style.background=v}}(e)}),q.onmousedown=e=>{q.onmousemove=e=>{if(j){let t=4*(Math.floor(e.offsetY)*q.width+Math.floor(e.offsetX)),n=L.getImageData(0,0,q.width,q.height),o=n.data[t],r=n.data[t+1],l=n.data[t+2],a=n.data[t+3];j=!1,p=v,v="rgba("+o+","+r+","+l+","+a+")",f.style.background=v,i.style.background=p}else{S=document.querySelector("#pencil"),localStorage.setItem("imgData",q.toDataURL());let t=e.offsetX,n=e.offsetY;L.fillRect(t-5,n-5,10,10),L.fillStyle=v,L.fill()}},q.onmouseup=()=>{q.onmousemove=null}},u.onmousedown=()=>{const e=10*(""===a.value?1:a.value);null!=S&&(S.style.background="#ffffff"),(S=u).style.background="rgba(180, 149, 255, 0.5)";for(let t=0;t<q.height;t++)for(let n=0;n<q.width;n++)L.fillStyle=v,L.fillRect(n*e,t*e,e,e)},s.onmousedown=()=>{j=!0,null!=S&&(S.style.background="#ffffff"),(S=s).style.background="rgba(180, 149, 255, 0.5)",f.style.background=v},window.onkeyup=e=>{switch(e.key){case"B":null!=S&&(S.style.background="#ffffff"),(S=u).style.background="rgba(180, 149, 255, 0.5)",R(),j=!1;break;case"P":null!=S&&(S.style.background="#ffffff"),(S=d).style.background="rgba(180, 149, 255, 0.5)",j=!1;break;case"C":null!=S&&(S.style.background="#ffffff"),(S=s).style.background="rgba(180, 149, 255, 0.5)",j=!0;break;case"b":null!=S&&(S.style.background="#ffffff"),(S=u).style.background="rgba(180, 149, 255, 0.5)",R(),j=!1;break;case"p":null!=S&&(S.style.background="#ffffff"),(S=d).style.background="rgba(180, 149, 255, 0.5)",j=!1;break;case"c":null!=S&&(S.style.background="#ffffff"),(S=s).style.background="rgba(180, 149, 255, 0.5)",j=!0}},document.addEventListener("DOMContentLoaded",()=>{c.addEventListener("click",()=>{!async function(){let e=l.value;""!==e&&(h=h.replace(w,e),w=e);await fetch(h).then(e=>e.json()).then(e=>{M(256,e.urls.small)})}()}),m.addEventListener("click",()=>{O(m)}),k.addEventListener("click",()=>{O(k)}),v.addEventListener("click",()=>{O(v)}),p.addEventListener("click",()=>{O(p)})})}]);