!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t){const o=document.querySelector("canvas"),n=document.querySelector(".matrixs"),r=document.querySelector(".colors"),a=document.querySelector(".findLoc"),l=document.querySelector("#size"),c=document.querySelector("#load"),u=document.querySelector("#blackAndWhite"),s=document.querySelector("#paint-bucket"),d=document.querySelector("#choose-color"),f=document.querySelector("#pencil"),i=document.querySelector(".current-color"),g=document.querySelector(".prev-color"),b=n.querySelector("#small"),m=n.querySelector("#medium"),y=n.querySelector("#big"),k=r.querySelector("#red"),h=r.querySelector("#blue"),S=document.querySelector("canvas"),p=S.getContext("2d");var v="https://api.unsplash.com/photos/random?query=town,Minsk&client_id=fec156f271c0811c8231098435c111c587352eaffae03b1d3a898cc877dd1b33",w=localStorage.getItem("prevColorState"),q=localStorage.getItem("currentColorState")||"green",L="Minsk",I=void 0,D=!1,j=1;function E(e,t){let o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="json",o.onload=()=>{let e=o.status;200==e?t(null,o.response):t(e)},o.send()}function x(e,t){const n=""===l.value?1:l.value,r=e[0].length,a=e.length,c=10*n;o.width=r*c,o.height=a*c;for(let o=0;o<a;o++)for(let n=0;n<r;n++)p.fillStyle="hex"===t?"#"+e[o][n]:"rgba("+e[o][n]+")",p.fillRect(n*c,o*c,c,c);localStorage.setItem("imgData",S.toDataURL())}function M(e,t){p.clearRect(0,0,S.width,S.height);const n=""===l.value?1:l.value,r=e||drawing.width,a=e||drawing.height,c=1*n;o.width=r*c,o.height=a*c,drawing=new Image,drawing.setAttribute("crossOrigin",""),drawing.src=t||"./data/image.png",drawing.classList.add("trueSize"),drawing.onload=()=>{p.drawImage(drawing,0,0)},localStorage.setItem("imgData",drawing.src)}function R(e){alert("Something went wrong: "+e)}function O(e){e==k?(w=q,q="red",i.style.background=q,g.style.background=w):e==h?(w=q,q="blue",i.style.background=q,g.style.background=w):e==q?(w=q,i.style.background=q,g.style.background=w):(w=q=w,i.style.background=q,g.style.background=w),localStorage.setItem("prevColorState",w),localStorage.setItem("currentColorState",q),p.fillStyle=q}o.addEventListener("mousedown",(function(){!0})),o.addEventListener("mouseup",(function(){!1})),i.style.background=q;let C=localStorage.getItem("imgData")||null;if(null!==C){let e=new Image;e.src=C,e.onload=()=>{p.drawImage(e,0,0,512,512)}}function _(){const e=10*(""===l.value?1:l.value);null!=I&&(I.style.background="#ffffff"),(I=s).style.background="rgba(180, 149, 255, 0.5)";for(let t=0;t<S.height;t++)for(let o=0;o<S.width;o++)p.fillStyle=q,p.fillRect(o*e,t*e,e,e);localStorage.setItem("imgData",S.toDataURL())}b.addEventListener("click",()=>{E("https://raw.githubusercontent.com/AntonChanin/tasks/master/tasks/stage-2/codejam-canvas/data/4x4.json",(e,t)=>{j=128,e?R(e):x(t,"hex")})}),m.addEventListener("click",()=>{E("https://raw.githubusercontent.com/rolling-scopes-school/tasks/master/tasks/stage-2/codejam-canvas/data/32x32.json",(e,t)=>{j=256,e?R(e):x(t,"rgba")})}),y.addEventListener("click",()=>{j=512,M(256)}),["#current-color","#prev-color","#red","#blue","#choose-color","#transform","#pencil","#small","#medium","#big"].map(e=>{!function(e){document.querySelector(e).onmousedown=()=>{null!=I&&(I.style.background="#ffffff"),(I=document.querySelector(e)).style.background="rgba(180, 149, 255, 0.5)",i.style.background=q}}(e)}),S.onmousedown=e=>{S.onmousemove=e=>{if(D){let t=4*(Math.floor(e.offsetY)*S.width+Math.floor(e.offsetX)),o=p.getImageData(0,0,S.width,S.height),n=o.data[t],r=o.data[t+1],a=o.data[t+2],l=o.data[t+3];D=!1,w=q,q="rgba("+n+","+r+","+a+","+l+")",i.style.background=q,g.style.background=w}else{I=f,localStorage.setItem("imgData",S.toDataURL());let t=e.offsetX,o=e.offsetY;p.fillRect(t-5,o-5,10,10),p.fillStyle=q,p.fill()}},S.onmouseup=()=>{S.onmousemove=null}},s.onmousedown=()=>{const e=10*(""===l.value?1:l.value);null!=I&&(I.style.background="#ffffff"),(I=s).style.background="rgba(180, 149, 255, 0.5)";for(let t=0;t<S.height;t++)for(let o=0;o<S.width;o++)p.fillStyle=q,p.fillRect(o*e,t*e,e,e)},d.onmousedown=()=>{D=!0,null!=I&&(I.style.background="#ffffff"),(I=d).style.background="rgba(180, 149, 255, 0.5)",i.style.background=q},window.onkeyup=e=>{switch(e.key){case"B":null!=I&&(I.style.background="#ffffff"),(I=s).style.background="rgba(180, 149, 255, 0.5)",_(),D=!1;break;case"P":null!=I&&(I.style.background="#ffffff"),(I=f).style.background="rgba(180, 149, 255, 0.5)",D=!1;break;case"C":null!=I&&(I.style.background="#ffffff"),(I=d).style.background="rgba(180, 149, 255, 0.5)",D=!0;break;case"b":null!=I&&(I.style.background="#ffffff"),(I=s).style.background="rgba(180, 149, 255, 0.5)",_(),D=!1;break;case"p":null!=I&&(I.style.background="#ffffff"),(I=f).style.background="rgba(180, 149, 255, 0.5)",D=!1;break;case"c":null!=I&&(I.style.background="#ffffff"),(I=d).style.background="rgba(180, 149, 255, 0.5)",D=!0}},document.addEventListener("DOMContentLoaded",()=>{c.addEventListener("click",()=>{!async function(){let e=a.value;""!==e&&(v=v.replace(L,e),L=e);await fetch(v).then(e=>e.json()).then(e=>{M(j,e.urls.small)})}()}),k.addEventListener("click",()=>{O(k)}),h.addEventListener("click",()=>{O(h)}),i.addEventListener("click",()=>{O(q)}),g.addEventListener("click",()=>{O(w)}),u.addEventListener("click",()=>{!function(){for(var e=p.getImageData(0,0,S.width,S.height),t=e.data,o=0;o<t.length;o+=4){var n=.2126*t[o]+.7152*t[o+1]+.0722*t[o+2];t[o]=t[o+1]=t[o+2]=n}p.putImageData(e,0,0),localStorage.setItem("imgData",S.toDataURL())}()})})}]);