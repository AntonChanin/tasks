!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t){const o=document.querySelector("canvas"),n=document.querySelector(".matrixs"),r=document.querySelector(".colors"),l=document.querySelector(".findLoc"),a=document.querySelector("#size"),c=document.querySelector("#load"),u=document.querySelector("#paint-bucket"),s=document.querySelector("#choose-color"),d=document.querySelector(".current-color"),f=document.querySelector(".prev-color"),i=n.querySelector("#small"),g=n.querySelector("#medium"),m=n.querySelector("#big");r.querySelector("#red"),r.querySelector("#blue");var y="https://api.unsplash.com/photos/random?query=town,Minsk&client_id=fec156f271c0811c8231098435c111c587352eaffae03b1d3a898cc877dd1b33",b=void 0,h="green",k="Minsk",p=void 0,S=document.querySelector("canvas"),w=S.getContext("2d"),v=!1;function q(e,t){var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="json",o.onload=()=>{var e=o.status;200==e?t(null,o.response):t(e)},o.send()}function j(e,t){const n=""===a.value?1:a.value,r=e[0].length,l=e.length,c=10*n;o.width=r*c,o.height=l*c;for(let o=0;o<l;o++)for(let n=0;n<r;n++)w.fillStyle="hex"===t?"#"+e[o][n]:"rgba("+e[o][n]+")",w.fillRect(n*c,o*c,c,c);localStorage.setItem("imgData",S.toDataURL())}function L(e,t){w.clearRect(0,0,S.width,S.height);const n=""===a.value?1:a.value,r=e||drawing.width,l=e||drawing.height,c=1*n;o.width=r*c,o.height=l*c,drawing=new Image,drawing.setAttribute("crossOrigin",""),drawing.src=t||"./data/image.png",drawing.classList.add("trueSize"),drawing.onload=()=>{w.drawImage(drawing,0,0)},localStorage.setItem("imgData",drawing.src)}function x(e){alert("Something went wrong: "+e)}o.addEventListener("mousedown",(function(){!0})),o.addEventListener("mouseup",(function(){!1})),d.style.background=h;let M=localStorage.getItem("imgData")||null;if(null!==M){let e=new Image;e.src=M,e.onload=()=>{w.drawImage(e,0,0,512,512)}}function I(){null!=p&&(p.style.background="#ffffff"),(p=u).style.background="rgba(180, 149, 255, 0.5)";let e=10*a.value;for(let t=0;t<S.height;t++)for(let o=0;o<S.width;o++)w.fillStyle=h,w.fillRect(o*e,t*e,e,e)}i.addEventListener("click",()=>{q("https://raw.githubusercontent.com/AntonChanin/tasks/master/tasks/stage-2/codejam-canvas/data/4x4.json",(e,t)=>{e?x(e):j(t,"hex")})}),g.addEventListener("click",()=>{q("https://raw.githubusercontent.com/rolling-scopes-school/tasks/master/tasks/stage-2/codejam-canvas/data/32x32.json",(e,t)=>{e?x(e):j(t,"rgba")})}),m.addEventListener("click",()=>{L(256)}),["#current-color","#prev-color","#red","#blue","#choose-color","#transform","#pencil","#small","#medium","#big"].map(e=>{!function(e){document.querySelector(e).onmousedown=()=>{null!=p&&(p.style.background="#ffffff"),(p=document.querySelector(e)).style.background="rgba(180, 149, 255, 0.5)",d.style.background=h}}(e)}),S.onmousedown=e=>{S.onmousemove=e=>{if(v){let t=4*(Math.floor(e.offsetY)*S.width+Math.floor(e.offsetX)),o=w.getImageData(0,0,S.width,S.height),n=o.data[t],r=o.data[t+1],l=o.data[t+2],a=o.data[t+3];v=!1,b=h,h="rgba("+n+","+r+","+l+","+a+")",d.style.background=h,f.style.background=b}else{p=document.querySelector("#pencil"),localStorage.setItem("imgData",S.toDataURL());let t=e.offsetX,o=e.offsetY;w.fillRect(t-5,o-5,10,10),w.fillStyle=h,w.fill()}},S.onmouseup=()=>{S.onmousemove=null}},u.onmousedown=()=>{null!=p&&(p.style.background="#ffffff"),(p=u).style.background="rgba(180, 149, 255, 0.5)";let e=10*a.value;for(let t=0;t<S.height;t++)for(let o=0;o<S.width;o++)w.fillStyle=h,w.fillRect(o*e,t*e,e,e)},s.onmousedown=()=>{v=!0,null!=p&&(p.style.background="#ffffff"),(p=document.querySelector("#choose-color")).style.background="rgba(180, 149, 255, 0.5)",d.style.background=h},window.onkeyup=e=>{switch(e.key){case"B":null!=p&&(p.style.background="#ffffff"),(p=u).style.background="rgba(180, 149, 255, 0.5)",I(),v=!1;break;case"P":null!=p&&(p.style.background="#ffffff"),(p=document.querySelector("#pencil")).style.background="rgba(180, 149, 255, 0.5)",v=!1;break;case"C":null!=p&&(p.style.background="#ffffff"),(p=document.querySelector("#choose-color")).style.background="rgba(180, 149, 255, 0.5)",v=!0;break;case"b":null!=p&&(p.style.background="#ffffff"),(p=u).style.background="rgba(180, 149, 255, 0.5)",I(),v=!1;break;case"p":null!=p&&(p.style.background="#ffffff"),(p=document.querySelector("#pencil")).style.background="rgba(180, 149, 255, 0.5)",v=!1;break;case"c":null!=p&&(p.style.background="#ffffff"),(p=document.querySelector("#choose-color")).style.background="rgba(180, 149, 255, 0.5)",v=!0}},document.addEventListener("DOMContentLoaded",()=>{c.addEventListener("click",()=>{!async function(){let e=l.value;""!==e&&(y=y.replace(k,e),k=e);await fetch(y).then(e=>e.json()).then(e=>{L(256,e.urls.small)})}()})})}]);