!function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t){const o=document.querySelector("canvas"),r=document.querySelector(".matrixs"),n=document.querySelector(".colors"),a=document.querySelector(".findLoc"),l=document.querySelector("#size"),c=document.querySelector("#load"),u=document.querySelector("#blackAndWhite"),d=document.querySelector("#paint-bucket"),s=document.querySelector("#choose-color"),i=document.querySelector("#pencil"),f=document.querySelector(".current-color"),g=document.querySelector(".prev-color"),m=r.querySelector("#small"),b=r.querySelector("#medium"),y=r.querySelector("#big"),k=n.querySelector("#red"),p=n.querySelector("#blue"),S=document.querySelector("canvas"),h=S.getContext("2d");var v="https://api.unsplash.com/photos/random?query=town,Minsk&client_id=fec156f271c0811c8231098435c111c587352eaffae03b1d3a898cc877dd1b33",w=localStorage.getItem("prevColorState"),q=localStorage.getItem("currentColorState")||"green",I="Minsk",L=void 0,j=!1,E=1;function D(e,t){let o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="json",o.onload=()=>{let e=o.status;200==e?t(null,o.response):t(e)},o.send()}function M(e){e==k?(w=q,q="red",f.style.background=q,g.style.background=w):e==p?(w=q,q="blue",f.style.background=q,g.style.background=w):e==q?(w=q,f.style.background=q,g.style.background=w):(w=q=w,f.style.background=q,g.style.background=w),localStorage.setItem("prevColorState",w),localStorage.setItem("currentColorState",q),h.fillStyle=q}o.addEventListener("mousedown",(function(){!0})),o.addEventListener("mouseup",(function(){!1})),f.style.background=q;let x=localStorage.getItem("imgData")||null;if(null!==x){let e=new Image;e.src=x,e.onload=()=>{h.drawImage(e,0,0,512,512)}}function O(){const e=10*(""===l.value?1:l.value);null!=L&&(L.style.background="#ffffff"),(L=d).style.background="rgba(180, 149, 255, 0.5)";for(let t=0;t<S.height;t++)for(let o=0;o<S.width;o++)h.fillStyle=q,h.fillRect(o*e,t*e,e,e);localStorage.setItem("imgData",S.toDataURL())}m.addEventListener("click",()=>{D("https://raw.githubusercontent.com/AntonChanin/tasks/master/tasks/stage-2/codejam-canvas/data/4x4.json",(e,t)=>{E=128,h.drawImage(img,0,0,128,128)})}),b.addEventListener("click",()=>{D("https://raw.githubusercontent.com/rolling-scopes-school/tasks/master/tasks/stage-2/codejam-canvas/data/32x32.json",(e,t)=>{E=256,h.drawImage(img,0,0,256,256)})}),y.addEventListener("click",()=>{E=512,h.drawImage(img,0,0,512,512)}),["#current-color","#prev-color","#red","#blue","#choose-color","#transform","#pencil","#small","#medium","#big"].map(e=>{!function(e){document.querySelector(e).onmousedown=()=>{null!=L&&(L.style.background="#ffffff"),(L=document.querySelector(e)).style.background="rgba(180, 149, 255, 0.5)",f.style.background=q}}(e)}),S.onmousedown=e=>{S.onmousemove=e=>{if(j){let t=4*(Math.floor(e.offsetY)*S.width+Math.floor(e.offsetX)),o=h.getImageData(0,0,S.width,S.height),r=o.data[t],n=o.data[t+1],a=o.data[t+2],l=o.data[t+3];j=!1,w=q,q="rgba("+r+","+n+","+a+","+l+")",f.style.background=q,g.style.background=w}else{L=i,localStorage.setItem("imgData",S.toDataURL());let t=e.offsetX,o=e.offsetY;h.fillRect(t-5,o-5,10,10),h.fillStyle=q,h.fill()}},S.onmouseup=()=>{S.onmousemove=null}},d.onmousedown=()=>{const e=10*(""===l.value?1:l.value);null!=L&&(L.style.background="#ffffff"),(L=d).style.background="rgba(180, 149, 255, 0.5)";for(let t=0;t<S.height;t++)for(let o=0;o<S.width;o++)h.fillStyle=q,h.fillRect(o*e,t*e,e,e)},s.onmousedown=()=>{j=!0,null!=L&&(L.style.background="#ffffff"),(L=s).style.background="rgba(180, 149, 255, 0.5)",f.style.background=q},window.onkeyup=e=>{switch(e.key){case"B":null!=L&&(L.style.background="#ffffff"),(L=d).style.background="rgba(180, 149, 255, 0.5)",O(),j=!1;break;case"P":null!=L&&(L.style.background="#ffffff"),(L=i).style.background="rgba(180, 149, 255, 0.5)",j=!1;break;case"C":null!=L&&(L.style.background="#ffffff"),(L=s).style.background="rgba(180, 149, 255, 0.5)",j=!0;break;case"b":null!=L&&(L.style.background="#ffffff"),(L=d).style.background="rgba(180, 149, 255, 0.5)",O(),j=!1;break;case"p":null!=L&&(L.style.background="#ffffff"),(L=i).style.background="rgba(180, 149, 255, 0.5)",j=!1;break;case"c":null!=L&&(L.style.background="#ffffff"),(L=s).style.background="rgba(180, 149, 255, 0.5)",j=!0}},document.addEventListener("DOMContentLoaded",()=>{c.addEventListener("click",()=>{!async function(){let e=a.value;""!==e&&(v=v.replace(I,e),I=e);await fetch(v).then(e=>e.json()).then(e=>{!function(e,t){h.clearRect(0,0,S.width,S.height);const r=""===l.value?1:l.value,n=e||drawing.width,a=e||drawing.height,c=1*r;o.width=n*c,o.height=a*c,drawing=new Image,drawing.setAttribute("crossOrigin",""),drawing.src=t||"./data/image.png",drawing.classList.add("trueSize"),drawing.onload=()=>{h.drawImage(drawing,0,0)},localStorage.setItem("imgData",drawing.src)}(E,e.urls.small)})}()}),k.addEventListener("click",()=>{M(k)}),p.addEventListener("click",()=>{M(p)}),f.addEventListener("click",()=>{M(q)}),g.addEventListener("click",()=>{M(w)}),u.addEventListener("click",()=>{!function(){for(var e=h.getImageData(0,0,S.width,S.height),t=e.data,o=0;o<t.length;o+=4){var r=.2126*t[o]+.7152*t[o+1]+.0722*t[o+2];t[o]=t[o+1]=t[o+2]=r}h.putImageData(e,0,0),localStorage.setItem("imgData",S.toDataURL())}()})})}]);