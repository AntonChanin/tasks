!function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t){const o=document.querySelector("canvas"),r=document.querySelector(".matrixs"),n=document.querySelector(".colors"),l=(document.querySelector(".findLoc"),document.querySelector("#size")),a=document.querySelector("#paint-bucket"),c=document.querySelector("#choose-color"),u=document.querySelector(".current-color"),f=document.querySelector(".prev-color"),s=r.querySelector("#small"),d=r.querySelector("#medium"),i=r.querySelector("#big");n.querySelector("#red"),n.querySelector("#blue");var g=void 0,y="green",b=void 0,m=document.querySelector("canvas"),k=m.getContext("2d"),S=!1;function p(e,t){var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="json",o.onload=()=>{var e=o.status;200==e?t(null,o.response):t(e)},o.send()}function h(e,t){const r=""===l.value?1:l.value,n=e[0].length,a=e.length,c=10*r;o.width=n*c,o.height=a*c;for(let o=0;o<a;o++)for(let r=0;r<n;r++)k.fillStyle="hex"===t?"#"+e[o][r]:"rgba("+e[o][r]+")",k.fillRect(r*c,o*c,c,c);localStorage.setItem("imgData",m.toDataURL())}function v(e){alert("Something went wrong: "+e)}o.addEventListener("mousedown",(function(){!0})),o.addEventListener("mouseup",(function(){!1})),u.style.background=y;let w=localStorage.getItem("imgData")||null;if(null!==w){let e=new Image;e.src=w,e.onload=function(){k.drawImage(e,0,0,512,512)}}function q(){null!=b&&(b.style.background="#ffffff"),(b=a).style.background="rgba(180, 149, 255, 0.5)";let e=10*l.value;for(let t=0;t<m.height;t++)for(let o=0;o<m.width;o++)k.fillStyle=y,k.fillRect(o*e,t*e,e,e)}s.addEventListener("click",()=>{p("https://raw.githubusercontent.com/AntonChanin/tasks/master/tasks/stage-2/codejam-canvas/data/4x4.json",(e,t)=>{e?v(e):h(t,"hex")})}),d.addEventListener("click",()=>{p("https://raw.githubusercontent.com/rolling-scopes-school/tasks/master/tasks/stage-2/codejam-canvas/data/32x32.json",(e,t)=>{e?v(e):h(t,"rgba")})}),i.addEventListener("click",()=>{const e=1*(""===l.value?1:l.value);o.width=256*e,o.height=256*e,drawing=new Image,drawing.setAttribute("crossOrigin",""),drawing.src="./data/image.png",drawing.classList.add("trueSize"),drawing.onload=()=>{k.drawImage(drawing,0,0)},localStorage.setItem("imgData",m.toDataURL())}),["#current-color","#prev-color","#red","#blue","#choose-color","#transform","#pencil","#small","#medium","#big"].map(e=>{!function(e){document.querySelector(e).onmousedown=()=>{null!=b&&(b.style.background="#ffffff"),(b=document.querySelector(e)).style.background="rgba(180, 149, 255, 0.5)",u.style.background=y}}(e)}),m.onmousedown=e=>{m.onmousemove=e=>{if(S){let t=4*(Math.floor(e.offsetY)*m.width+Math.floor(e.offsetX)),o=k.getImageData(0,0,m.width,m.height),r=o.data[t],n=o.data[t+1],l=o.data[t+2],a=o.data[t+3];S=!1,g=y,y="rgba("+r+","+n+","+l+","+a+")",u.style.background=y,f.style.background=g}else{b=document.querySelector("#pencil"),localStorage.setItem("imgData",m.toDataURL());let t=e.offsetX,o=e.offsetY;k.fillRect(t-5,o-5,10,10),k.fillStyle=y,k.fill()}},m.onmouseup=()=>{m.onmousemove=null}},a.onmousedown=()=>{null!=b&&(b.style.background="#ffffff"),(b=a).style.background="rgba(180, 149, 255, 0.5)";let e=10*l.value;for(let t=0;t<m.height;t++)for(let o=0;o<m.width;o++)k.fillStyle=y,k.fillRect(o*e,t*e,e,e)},c.onmousedown=()=>{S=!0,null!=b&&(b.style.background="#ffffff"),(b=document.querySelector("#choose-color")).style.background="rgba(180, 149, 255, 0.5)",u.style.background=y},window.onkeyup=e=>{switch(e.key){case"B":null!=b&&(b.style.background="#ffffff"),(b=a).style.background="rgba(180, 149, 255, 0.5)",q(),S=!1;break;case"P":null!=b&&(b.style.background="#ffffff"),(b=document.querySelector("#pencil")).style.background="rgba(180, 149, 255, 0.5)",S=!1;break;case"C":null!=b&&(b.style.background="#ffffff"),(b=document.querySelector("#choose-color")).style.background="rgba(180, 149, 255, 0.5)",S=!0;break;case"b":null!=b&&(b.style.background="#ffffff"),(b=a).style.background="rgba(180, 149, 255, 0.5)",q(),S=!1;break;case"p":null!=b&&(b.style.background="#ffffff"),(b=document.querySelector("#pencil")).style.background="rgba(180, 149, 255, 0.5)",S=!1;break;case"c":null!=b&&(b.style.background="#ffffff"),(b=document.querySelector("#choose-color")).style.background="rgba(180, 149, 255, 0.5)",S=!0}}}]);